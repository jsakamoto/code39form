{"version":3,"sources":["src/language-pack/language-pack/language-pack.ja.ts","src/index.ts"],"names":["Code39Form","languagePacks","ja","add","remove","print","Are you sure you want to remove it?","updateBarcodeImage","inputLine","$inputLine","$","id","html","barcode","text","barWidth","showHRI","updateUIState","toggleClass","inputLines","length","localizeText","langPack","setFocus","focus","each","i","elem","removeClass","storageService","get","key","localStorage","getItem","put","value","setItem","cookie","inputLinesJson","JSON","parse","$inputLinesContainer","source","template","Handlebars","compile","window","navigator","language","forEach","append","browserIsKindle","userAgent","split","indexOf","document","body","matches","location","hostname","match","repositoryUrl","pathname","filter","s","shift","source_1","on","newId","map","l","reduce","prev","current","Math","max","newLine","push","stringify","e","target","closest","lineId","data","prompt","confirm","line","pop","index","splice","input","setTimeout","newText","toUpperCase","undefined","onerror","message","url","lineNumber","columnNumber","exception","stack","alert"],"mappings":"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","file":"index.min.js","sourcesContent":["namespace Code39Form {\r\n    languagePacks = languagePacks || {};\r\n    languagePacks.ja = {\r\n        \"add\": \"追加\",\r\n        \"remove\": \"削除\",\r\n        \"print\": \"印刷\",\r\n        \"Are you sure you want to remove it?\": \"削除してもよろしいですか?\"\r\n    };\r\n}","\r\nnamespace Code39Form {\r\n\r\n    interface InputLine {\r\n        id: number;\r\n        text: string;\r\n    }\r\n\r\n    interface StorageService {\r\n        get(key: string): string;\r\n        put(key: string, value: string): void;\r\n    }\r\n\r\n    // Initialize storage service.\r\n    let storageService = initializeStorageService();\r\n\r\n    let inputLinesJson = storageService.get('inputLines') || '[{\"id\":1,\"text\":\"\"}]';\r\n    let inputLines = JSON.parse(inputLinesJson) as InputLine[];\r\n\r\n    let $inputLinesContainer = $('.input-lines-container');\r\n\r\n    // Prepare template.\r\n    let source = $(\"#line-template\").html();\r\n    let template = Handlebars.compile(source);\r\n\r\n    var langPack = (languagePacks || {})[window.navigator.language] || {};\r\n\r\n    // Initial display view.\r\n    inputLines.forEach(inputLine => {\r\n        let html = template(inputLine);\r\n        $inputLinesContainer.append(html);\r\n        updateBarcodeImage(inputLine);\r\n    });\r\n    updateUIState();\r\n\r\n    let userAgentParts = window.navigator.userAgent.split(/[ ,/;:()]/);\r\n    let browserIsKindle = userAgentParts.indexOf('Kindle') != -1;\r\n    $(document.body).toggleClass('print-disabled', browserIsKindle);\r\n\r\n    // Show repository information if I'm on GitHub pages.\r\n    var matches = location.hostname.match(/^([^.]+)\\.github\\.io$/i);\r\n    if (matches != null) {\r\n        let ownerName = matches[1];\r\n        let projectName = location.pathname.split('/').filter(s => s != '').shift();\r\n        let repositoryUrl = `https://github.com/${ownerName}/${projectName}`;\r\n        let source = $(\"#repository-info-template\").html();\r\n        let template = Handlebars.compile(source);\r\n        let html = template({ repositoryUrl });\r\n        $('.repository-info').html(html);\r\n    }\r\n\r\n    // Wire up event handlers.\r\n\r\n    $(document).on('click', '.add-input-line', () => {\r\n        let newId = inputLines.map(l => l.id).reduce((prev, current) => Math.max(prev, current)) + 1;\r\n        let newLine = { id: newId, text: '' };\r\n        let html = template(newLine);\r\n        $inputLinesContainer.append(html);\r\n\r\n        inputLines.push(newLine);\r\n        storageService.put('inputLines', JSON.stringify(inputLines));\r\n        updateUIState();\r\n        setFocus(newId);\r\n    });\r\n\r\n    $(document).on('click', '.remove-input-line:not(.disabled)', (e) => {\r\n        let $inputLine = $(e.target).closest('.input-line');\r\n        let lineId = $inputLine.data('line-id');\r\n        if ($('.input-line').length < 2) return;\r\n        let prompt = 'Are you sure you want to remove it?';\r\n        if (!confirm(langPack[prompt] || prompt)) {\r\n            setFocus(lineId);\r\n            return;\r\n        }\r\n\r\n        $inputLine.remove();\r\n\r\n        let inputLine = inputLines.filter(line => line.id == lineId).pop();\r\n        let index = inputLines.indexOf(inputLine);\r\n        inputLines.splice(index, 1);\r\n\r\n        storageService.put('inputLines', JSON.stringify(inputLines));\r\n        updateUIState();\r\n        setFocus((inputLines[index] || inputLines[inputLines.length - 1]).id);\r\n    });\r\n\r\n    $(document).on('change keydown paste', '.input-line .control input:text', (e) => {\r\n        let $inputLine = $(e.target).closest('.input-line');\r\n        let lineId = $inputLine.data('line-id') as number;\r\n        let input = e.target as HTMLInputElement;\r\n        setTimeout(() => {\r\n            let newText = input.value.toUpperCase();\r\n            let inputLine = inputLines.filter(line => line.id == lineId).pop();\r\n            if (inputLine != undefined && inputLine.text != newText) {\r\n                inputLine.text = newText;\r\n                updateBarcodeImage(inputLine);\r\n                storageService.put('inputLines', JSON.stringify(inputLines));\r\n            }\r\n\r\n        }, 0);\r\n    });\r\n\r\n    $(document).on('click', '.print', () => {\r\n        window.print();\r\n    });\r\n\r\n    function updateBarcodeImage(inputLine: InputLine): void {\r\n        let $inputLine = $('div[data-line-id=' + inputLine.id + ']');\r\n        $('.barcode-image', $inputLine).html('').barcode(inputLine.text, 'code39', { barWidth: 3, showHRI: false });\r\n        $('.human-readable .content', $inputLine).text(inputLine.text);\r\n    }\r\n\r\n    function updateUIState(): void {\r\n        $('.remove-input-line').toggleClass('disabled', inputLines.length < 2);\r\n        localizeText(langPack);\r\n    }\r\n\r\n    function setFocus(id: number): void {\r\n        $(`#barcode-input-${id}`).focus();\r\n    }\r\n\r\n    function initializeStorageService(): StorageService {\r\n\r\n        let enableLocalStorage = (typeof (localStorage) !== 'undefined');\r\n        let storageService = null as StorageService;\r\n        if (enableLocalStorage == true) {\r\n            storageService = {\r\n                get: (key: string) => localStorage.getItem(key),\r\n                put: (key: string, value: string) => localStorage.setItem(key, value)\r\n            };\r\n        }\r\n        else {\r\n            storageService = {\r\n                get: (key: string) => $.cookie(key),\r\n                put: (key: string, value: string) => $.cookie(key, value)\r\n            };\r\n        }\r\n        return storageService;\r\n    }\r\n\r\n    function localizeText(langPack: any): void {\r\n        $('.x-lang').each((i, elem) => {\r\n            let text = $(elem).text();\r\n            $(elem).text(langPack[text] || text).removeClass('.x-lang');\r\n        });\r\n    }\r\n\r\n    // Global error handling.\r\n    window.onerror = <any>function (message: string, url?: string, lineNumber?: number, columnNumber?: number, exception?: Error) {\r\n        exception = exception || <any>{ message, stack: `${url || '- unknown souce file -'}(${lineNumber}:${columnNumber})` };\r\n        alert(exception);\r\n    };\r\n}"]}